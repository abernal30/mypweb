<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Machine learning introductory guide in R. v.1.2</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Machine learning introductory guide in R. v.1.2" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Machine learning introductory guide in R. v.1.2" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Arturo Bernal" />


<meta name="date" content="2022-03-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="data-collection.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="big-picture.html"><a href="big-picture.html"><i class="fa fa-check"></i><b>1</b> Big picture<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="big-picture.html"><a href="big-picture.html#frame-the-problem"><i class="fa fa-check"></i><b>1.1</b> Frame the Problem<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="big-picture.html"><a href="big-picture.html#select-a-performance-measure"><i class="fa fa-check"></i><b>1.2</b> Select a Performance Measure<span></span></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="big-picture.html"><a href="big-picture.html#for-continuous-variables"><i class="fa fa-check"></i><b>1.2.1</b> For continuous variables<span></span></a></li>
<li class="chapter" data-level="1.2.2" data-path="big-picture.html"><a href="big-picture.html#for-categorical-variables-classification-methods"><i class="fa fa-check"></i><b>1.2.2</b> For categorical variables (classification methods)<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-collection.html"><a href="data-collection.html"><i class="fa fa-check"></i><b>2</b> Data collection<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-collection.html"><a href="data-collection.html#take-a-quick-look-at-the-data-structure"><i class="fa fa-check"></i><b>2.1</b> Take a Quick Look at the Data Structure<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="data-collection.html"><a href="data-collection.html#create-the-training-and-test-set"><i class="fa fa-check"></i><b>2.2</b> Create the training and Test Set<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-collection.html"><a href="data-collection.html#for-cros-sectional-data-or-no-time-series"><i class="fa fa-check"></i><b>2.2.1</b> For cros sectional data or no time series<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="data-collection.html"><a href="data-collection.html#for-time-series"><i class="fa fa-check"></i><b>2.2.2</b> For time series<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="discover-and-visualize-the-data-to-gain-insights.html"><a href="discover-and-visualize-the-data-to-gain-insights.html"><i class="fa fa-check"></i><b>3</b> 3 Discover and Visualize the Data to Gain Insights<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="discover-and-visualize-the-data-to-gain-insights.html"><a href="discover-and-visualize-the-data-to-gain-insights.html#looking-for-relationships-among-features-and-correlations"><i class="fa fa-check"></i><b>3.1</b> Looking for relationships among features and Correlations<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="discover-and-visualize-the-data-to-gain-insights.html"><a href="discover-and-visualize-the-data-to-gain-insights.html#experimenting-with-attribute-combinations"><i class="fa fa-check"></i><b>3.2</b> Experimenting with Attribute Combinations<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prepare-the-data-for-machine-learning-algorithms.html"><a href="prepare-the-data-for-machine-learning-algorithms.html"><i class="fa fa-check"></i><b>4</b> 4 Prepare the Data for Machine Learning Algorithms<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="prepare-the-data-for-machine-learning-algorithms.html"><a href="prepare-the-data-for-machine-learning-algorithms.html#data-cleaning"><i class="fa fa-check"></i><b>4.1</b> Data Cleaning<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="prepare-the-data-for-machine-learning-algorithms.html"><a href="prepare-the-data-for-machine-learning-algorithms.html#missing-values"><i class="fa fa-check"></i><b>4.2</b> Missing values<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="prepare-the-data-for-machine-learning-algorithms.html"><a href="prepare-the-data-for-machine-learning-algorithms.html#handling-text-and-categorical-attributes"><i class="fa fa-check"></i><b>4.3</b> Handling Text and Categorical Attributes<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="prepare-the-data-for-machine-learning-algorithms.html"><a href="prepare-the-data-for-machine-learning-algorithms.html#feature-scaling"><i class="fa fa-check"></i><b>4.4</b> Feature Scaling<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="select-and-train-and-evaluate-the-model.html"><a href="select-and-train-and-evaluate-the-model.html"><i class="fa fa-check"></i><b>5</b> 5 Select and Train and evaluate the Model<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="select-and-train-and-evaluate-the-model.html"><a href="select-and-train-and-evaluate-the-model.html#for-continuous-variables-1"><i class="fa fa-check"></i><b>5.1</b> For continuous variables<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="select-and-train-and-evaluate-the-model.html"><a href="select-and-train-and-evaluate-the-model.html#select-the-model-for-categorical-variables"><i class="fa fa-check"></i><b>5.2</b> Select the model for categorical variables<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="select-and-train-and-evaluate-the-model.html"><a href="select-and-train-and-evaluate-the-model.html#clasification-models"><i class="fa fa-check"></i><b>5.2.1</b> Clasification models<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="select-and-train-and-evaluate-the-model.html"><a href="select-and-train-and-evaluate-the-model.html#training-and-evaluating-on-the-training-set"><i class="fa fa-check"></i><b>5.2.2</b> Training and Evaluating on the Training Set<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="select-and-train-and-evaluate-the-model.html"><a href="select-and-train-and-evaluate-the-model.html#resampling-cross-validation"><i class="fa fa-check"></i><b>5.3</b> Resampling (cross-validation)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="fine-tune-or-tune-the-ml-model.html"><a href="fine-tune-or-tune-the-ml-model.html"><i class="fa fa-check"></i><b>6</b> 6 Fine-Tune or Tune the ML Model<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="fine-tune-or-tune-the-ml-model.html"><a href="fine-tune-or-tune-the-ml-model.html#analyze-the-best-models-and-their-errors"><i class="fa fa-check"></i><b>6.1</b> Analyze the Best Models and Their Errors<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="fine-tune-or-tune-the-ml-model.html"><a href="fine-tune-or-tune-the-ml-model.html#evaluate-your-system-on-the-test-set"><i class="fa fa-check"></i><b>6.2</b> Evaluate Your System on the Test Set<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>7</b> References<span></span></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine learning introductory guide in R. v.1.2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Machine learning introductory guide in R. v.1.2</h1>
<p class="author"><em><a href="https://www.arturo-bernal.com" target="_blank">Arturo Bernal</a></em></p>
<p class="date"><em>2022-03-17</em></p>
</div>
<div id="big-picture" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Big picture<a href="big-picture.html#big-picture" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="frame-the-problem" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Frame the Problem<a href="big-picture.html#frame-the-problem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Answer the following:
what is the business objective? or How does the company (client) expect to use and benefit from this model?</p>
<p>Knowing the objective is important because it will determine how you frame the problem, which algorithms you will select.</p>
<p>For the housing prices, the objective is to predict a district’s median housing price to detect investment opportunities, applying OLS ordinary least squares OLS. For example, your prediction may show that a house located in latitude x, longitude y, housing median age z, total rooms n, etc. has a median house value of 162,000. However, the house is for sale for $145,000, it may be an opportunity to buy something cheaper than it should cost.</p>
<p>For the Lending club credit default analysis, we will focus on predicting if a new customer would default the loan or not (will repay the loan or not).</p>
<p>what the current solution looks like (if any)?</p>
<p>Is important to have a comparison, to visualize the solution. For this case, The current situation will often give you a reference for performance, as well as insights on how to solve the problem.</p>
<p>For the case of the district housing prices, they currently estimated house prices manually by experts: a team gathers up-to-date information about a district, and when they cannot get the median housing price, they estimate it using complex rules.</p>
<p>Regarding the Lending club, we do not have evidence that Lending club applies machine learning methods to analyze the credit applications. But we will assume that as many other credit financial institution, the apply the method manually.</p>
</div>
<div id="select-a-performance-measure" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Select a Performance Measure<a href="big-picture.html#select-a-performance-measure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="for-continuous-variables" class="section level3 hasAnchor" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> For continuous variables<a href="big-picture.html#for-continuous-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Root Mean Square Error (RMSE). It gives an idea of how much error the system typically makes in its predictions, with a higher weight for large errors. Shows the mathematical formula to compute the RMSE. The mathematical formula to compute the RMSE is:</p>
<p><span class="math display">\[RMSE =\frac{1}{n}\ \sum_{i=1}^{n} (y_{i}-\hat{f(x_{i}))^{2}} \]</span></p>
<p>where $ $ is the prediction for the ith observation (the actual), $ y_{i} $ is the observation ith of the independent variable, and n is the number of observations.</p>
<p><span class="math display">\[\hat{f(x_{i})}=\hat{\beta_{0}}+\hat{\beta_{1}}x_{1}+,..,+\hat{\beta_{n}}x_{n}\]</span></p>
<p>The RMSE is computed using the training data that was used to fit the model, and so should more accurately be referred to as the training RMSE.</p>
<p>But in general, we do not really care how well the method works training on the training data. Rather, we are interested in the accuracy of the predictions that we obtain when we apply our method to previously unseen
test data.</p>
<p>Mean absolute error (MAE). Even though the RMSE is generally the preferred performance measure for regression tasks, in some contexts you may prefer to use another function. For example, suppose that there are many outlier districts. In that case, you may consider using the mean absolute error (MAE, also called the average absolute deviation;Mean absolute error (MAE).</p>
<p><span class="math display">\[MAE =\frac{1}{n}\ \sum_{i=1}^{n} |y_{i}-\hat{f(x_{i})|} \]</span></p>
<p>** Start section updated. Version v.1.2**</p>
</div>
<div id="for-categorical-variables-classification-methods" class="section level3 hasAnchor" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> For categorical variables (classification methods)<a href="big-picture.html#for-categorical-variables-classification-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Confusion matrix</p>
<p>Is a table that categorizes predictions according to whether they match the actual value. One of the table’s dimensions indicates the possible categories of predicted values, while the other dimension indicates the same for actual values. Although we have only seen 2 x 2 confusion matrices so far, a matrix can be created for models that predict any number of class values. The following figure shows a generic confusion matrix.</p>
<p><img class="featurette-image img-responsive center-block" src="cm2.jpeg" width="260" height="330"  alt="Generic placeholder image"></p>
<p>Where True Positive (TP): Correctly classified as the class of interest. True Negative (TN) is Correctly classified as not the class of interest. False Positive (FP) is Incorrectly classified as the class of interest. False Negative (FN): Incorrectly classified as not the class of interest.</p>
<p>In the confusion matrix, one of the mesures of interest is the accuracy, defined as:</p>
<p><span class="math display">\[ accuracy =\frac{TP+TN}{TP+TN+FP+FN}\]</span></p>
<p>In this formula, the terms TP, TN, FP, and FN refer to the number of times the model’s predictions fell into each of these categories. The accuracy is therefore a proportion that represents the number of true positives and true negatives, divided by the total number of predictions.</p>
<p>The error rate or the proportion of the incorrectly classified examples is specified as:</p>
<p><span class="math display">\[ error\ rate =\frac{FP+FN}{TP+TN+FP+FN}=1-acuracy\]</span>
Notice that the error rate can be calculated as one minus the accuracy. Intuitively, this makes sense; a model that is correct 95 percent of the time is incorrect 5 percent of the time.</p>
<p>Sensitivity and specificity</p>
<p>Finding a useful classifier often involves a balance between predictions that are overly conservative and overly aggressive. For example, an e-mail filter could guarantee to eliminate every spam message by aggressively eliminating nearly every ham message at the same time. On the other hand, guaranteeing that no ham message is inadvertently filtered might require us to allow an unacceptable amount of spam to pass through the filter. A pair of performance measures captures this trade off: sensitivity and specificity.</p>
<p>The sensitivity of a model (also called the true positive rate) measures the proportion of positive examples that were correctly classified. Therefore, as shown in the following formula, it is calculated as the number of true positives divided by the total number of positives, both correctly classified (the true positives) as well as incorrectly classified (the false negatives):</p>
<p><span class="math display">\[sensitivity =\frac{TP}{TP+FN}\]</span></p>
<p>Where True Positive (TP): Correctly classified as the class of interest and False Negative (FN): Incorrectly classified as not the class of interest</p>
<p>The specificity of a model (also called the true negative rate) measures the proportion of negative examples that were correctly classified. As with sensitivity, this is computed as the number of true negatives, divided by the total number of negatives—the true negatives plus the false positives:</p>
<p><span class="math display">\[ specificity =\frac{TN}{TN+FP}\]</span></p>
<p>True Negative (TN) is Correctly classified as not the class of interest and False Positive (FP) is Incorrectly classified as the class of interest</p>
<p>** End section updated. Version v.1.2**</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="data-collection.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
